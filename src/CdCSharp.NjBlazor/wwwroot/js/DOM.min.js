var e;(e||(e={})).DOMJsClass=class{constructor(){this.textPatternClickEvents=new WeakMap,this.textPatternInputEvents=new WeakMap,this.textPatternBlurEvents=new WeakMap,this.addTextPatternEvents=(e,t,n)=>{const s=()=>this.selectTextOnClick(e);this.textPatternClickEvents.get(e)||(e.addEventListener("click",s),this.textPatternClickEvents.set(e,s));const a=()=>this.goNextOrPrevent(e,t,n);this.textPatternInputEvents.get(e)||(e.addEventListener("input",a),this.textPatternInputEvents.set(e,a));const i=()=>this.setDefaultValueNotLength(e,n);this.textPatternBlurEvents.get(e)||(e.addEventListener("blur",i),this.textPatternBlurEvents.set(e,i))},this.selectTextOnClick=e=>{const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)},this.goNextOrPrevent=(e,t,n)=>{if(0!=e.innerText.length)if(e.innerText.length<=n.length){let s=this.getCursorPositionWithinSpan(e),a=n.pattern.replace(/[\\\(\)\^\$]/g,""),i=e.innerText,r=a.substring(0,i.length).split(""),o="";for(let e=0;e<i.length;e++){let t;"w"===r[e]?t=new RegExp("[a-zA-Z]","g").test(i[e]):"d"===r[e]&&(t=new RegExp("[0-9]","g").test(i[e])),t?o+=i[e]:s-=1}if(e.innerText=o,this.setCursorPositionWithinSpan(e,s),e.innerText.length>=n.length){const n=this.findNextEditableBlock(t,e);n&&n.click()}}else e.innerText=e.innerText.substring(0,n.length),this.placeCaretAtEnd(e);else e.innerText=n.defaultValue},this.setDefaultValueNotLength=(e,t)=>{e.innerText.length==t.length||(e.innerText=t.defaultValue)},this.getCursorPositionWithinSpan=e=>{let t=0;if(window.getSelection){let n=window.getSelection();if(n&&n.rangeCount>0){let s=n.getRangeAt(0),a=s.cloneRange();a.selectNodeContents(e),a.setEnd(s.startContainer,s.startOffset),t=a.toString().length}}return t},this.setCursorPositionWithinSpan=(e,t)=>{let n=document.createRange(),s=window.getSelection();s&&(n.setStart(e.childNodes[0]||e,t),n.collapse(!0),s.removeAllRanges(),s.addRange(n))},this.findNextEditableBlock=(e,t)=>{let n=!1;for(const s of e.children)if(s===t)n=!0;else if(n&&s instanceof HTMLSpanElement&&"true"===s.contentEditable)return s;return null},this.placeCaretAtEnd=e=>{const t=document.createRange(),n=window.getSelection();t.selectNodeContents(e),t.collapse(!1),n&&(n.removeAllRanges(),n.addRange(t))},this.inputFileHandlers=new WeakMap}async SetCssVariable(e,t){document.documentElement.style.setProperty(e,t)}async GetCssVariable(e){return getComputedStyle(document.documentElement).getPropertyValue(e)}async SaveLocalStorage(e,t){localStorage.setItem(e,t)}async GetLocalStorage(e){return localStorage.getItem(e)}async SelectText(e){const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t)}async GetCoordsRelative(e,t){const n=e.getBoundingClientRect().height,s=e.getBoundingClientRect().width;switch(t){case"center":return[0,0,0,0];case"top":return[0,0,n,0];case"right":return[0,0,0,s];case"bottom":return[n,0,0,0];case"left":return[0,s,0,0];case"topleft":return[0,s,n,0];case"topright":return[0,0,n,s];case"bottomleft":return[n,s,0,0];case"bottomright":return[n,0,0,s]}return[0,0,0,0]}async GetElementBounds(e){const t=document.querySelector(e);if(!t)return[0,0];const n=t.getBoundingClientRect(),s=n.height;return[n.width,s]}async SetCalendarDatepickerValue(e,t){e&&(e.value=t)}async AddShowPickerEventHandler(e,t){"true"!==e.dataset.showPickerListenerAttached&&(e.dataset.showPickerListenerAttached="true",e.addEventListener("click",(()=>{t.showPicker&&t.showPicker()})))}async TextPatternAddDynamic(e,t){e.innerHTML="",this.textPatternClickEvents=new WeakMap,this.textPatternInputEvents=new WeakMap,this.textPatternBlurEvents=new WeakMap;for(let n of t){let t=document.createElement("span");t.innerText=n.value,n.isSeparator||n.isEditable&&(t.setAttribute("contenteditable","true"),this.addTextPatternEvents(t,e,n)),e.appendChild(t)}}async FocusElement(e,t){t?t.querySelector(e)?.focus():document.querySelector(e)?.focus()}async GetFocusedElementClass(){return document.activeElement.classList.toString()}async InputFileInitializeCallbacks(e,t){if(this.inputFileHandlers.get(t))return;const n=n=>{const s=t.files;if(s){let t=[];for(let e=0;e<s.length;e++){let n=s.item(e);t.push({id:e,name:n.name,size:n.size,contentType:n.type,lastModified:new Date(n.lastModified).toISOString()})}e.invokeMethodAsync("NotifyChange",t)}};t.addEventListener("change",n),this.inputFileHandlers.set(t,n)}async ReadFileData(e,t){const n=e.files.item(t);return await this.readFileStreamAsync(n)}async ReadImageData(e,t){const n=e.files.item(t);return await this.readFileDataAsync(n)}async readFileDataAsync(e){return new Promise(((t,n)=>{const s=new FileReader;s.onload=()=>{t(s.result)},s.onerror=e=>{n(e)},s.readAsDataURL(e)}))}async readFileStreamAsync(e){return new Promise(((t,n)=>{const s=new FileReader;s.onload=()=>{t(s.result)},s.onerror=e=>{n(e)},s.readAsArrayBuffer(e)}))}async SetDisabled(e,t){e.disabled=t}async ScrollToClosest(e,t){let n=null;if(n=t?t.matches(e)?t:t.closest(e):document.querySelector(e),n){const e=n.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:e,behavior:"smooth"})}}async ScrollTop(e,t){if(t??=0,e){const n=e.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:n+t,behavior:"smooth"})}else window.scrollTo({top:t,behavior:"smooth"})}async DownloadFile(e,t,n="text/plain"){const s=new Blob([t],{type:n}),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=e,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(a),document.body.removeChild(i)}},window.DOMJs=new e.DOMJsClass;
//# sourceMappingURL=DOM.min.js.map
